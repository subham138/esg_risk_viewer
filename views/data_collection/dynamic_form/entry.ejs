<%- include('../../templates/header.ejs') %>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css">
    <style>
        /* .nomrgn {
            margin-left: 0px !important;
            margin-right: 0px !important;
        }

        .nopadd {
            padding: 0px !important;
        } */

        /* #modules {
            background: #eee;
            z-index: 1;
        } */

        /* .drag-field {
            padding-top: 15px !important;
        } */

        /* .drag-field a {
            width: 100%;
        } */
        .drag{
            width: 100%;
        }
        #dropzone {
            padding: 20px;
            /* background: #fff; */
            z-index: 0;
        }

        .active {
            outline: 1px solid red;
        }

        .hover {
            outline: 1px solid blue;
        }

        .drop-item .remove {
            display: none;
        }

        .drop-item:hover .remove {
            display: inherit;
        }

        .remove {
            background: no-repeat;
            border: none;
            font-size: 11px;
            color: red;
        }

        .drop-item {
            cursor: move;
            margin-bottom: 10px;
            background-color: rgb(255, 255, 255);
            padding: 20px;
            border: 1px solid rgb(204, 204, 204);
            position: relative;
        }

        .drop-item p {
            cursor: pointer;
            margin: 0;
        }

        .drop-item .remove {
            position: absolute;
            top: 4px;
            right: 4px;
        }
    </style>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12">
                <% if(message){ %>
                <div
                  class="alert alert-<%= message.type %> dark alert-dismissible fade show"
                  role="alert"
                >
                  <i data-feather="clock"></i>
                  <p><%= message.message %></p>
                  <button
                    class="btn-close"
                    type="button"
                    data-bs-dismiss="alert"
                    aria-label="Close"
                  ></button>
                </div>
                <% } %>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <div id="modules" class=" col-sm-12 drag-field nopadd">
                            <p class="drag col-sm-6"><a class="btn btn-default">Heading</a></p>
                            <p class="drag col-sm-6"><a class="btn btn-default">Sub-Heading</a></p>
                            <p class="drag col-sm-6"><a class="btn btn-default">Textarea</a></p>
                            <p class="drag col-sm-6"><a class="btn btn-default">List</a></p>
                            <p class="drag col-sm-6"><a class="btn btn-default">Table</a></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-9">
                <div class="card">
                    <div class="card-body">
                        <div id="dropzone" class="col-sm-12"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>
    <script>
        $('.drag').draggable({
            appendTo: 'body',
            helper: 'clone'
        });
        $('#dropzone').droppable({
            activeClass: 'active',
            hoverClass: 'hover',
            greedy: true,
            // accept: ":not(.ui-sortable-helper)", // Reject clones generated by sortable
            drop: function (e, ui) {
                switch (ui.draggable.text()) {
                    case 'Heading':
                        var $el = $('<div class="drop-item form-group"><h4 onclick="editLabel(this)">' + ui.draggable.text() + '</h4><input type="text" value="" name="" class="edit" id="edit" style="display: none;"></div>');
                        $el.append($('<button type="button" class="remove"><i class="icofont icofont-trash"></i></button>').click(function () { $(this).parent().detach(); }));
                        $(this).append($el);
                        break;
                    case 'Sub-Heading':
                        var $el = $('<div class="drop-item form-group"><h6 onclick="editLabel(this)">' + ui.draggable.text() + '</h6><input type="text" value="" name="" class="edit" id="edit" style="display: none;"></div>');
                        $el.append($('<button type="button" class="remove"><i class="icofont icofont-trash"></i></button>').click(function () { $(this).parent().detach(); }));
                        $(this).append($el);
                        break;
                    case 'Textarea':
                        var $el = $('<div class="drop-item form-group"><label><p onclick="editLabel(this)">' + ui.draggable.text() + '</p><input type="text" value="" name="" class="edit" id="edit" style="display: none;"></label><input class="form-control" type="email" /></div>');
                        $el.append($('<button type="button" class="remove"><i class="icofont icofont-trash"></i></button>').click(function () { $(this).parent().detach(); }));
                        $(this).append($el);
                        break;
                    case 'List':
                        var $el = $('<div class="drop-item form-group"><label><p onclick="editLabel(this)">' + ui.draggable.text() + '</p><input type="text" value="" name="" class="edit" id="edit" style="display: none;"></label><input class="form-control" type="email" /></div>');
                        $el.append($('<button type="button" class="remove"><i class="icofont icofont-trash"></i></button>').click(function () { $(this).parent().detach(); }));
                        $(this).append($el);
                        break;
                    case 'Table':
                        var $el = $('<div class="drop-item form-group"><label><p onclick="editLabel(this)">' + ui.draggable.text() + '</p><input type="text" value="" name="" class="edit" id="edit" style="display: none;"></label><input class="form-control" type="email" /></div>');
                        $el.append($('<button type="button" class="remove"><i class="icofont icofont-trash"></i></button>').click(function () { $(this).parent().detach(); }));
                        $(this).append($el);
                        break;
                
                    default:
                        break;
                }
                // if (ui.draggable.text() == "Textarea") {
                //     var $el = $('<div class="drop-item form-group"><label><p onclick="editLabel(this)">' + ui.draggable.text() + '</p><input type="text" value="" name="" class="edit" id="edit" style="display: none;"></label><textarea class="form-control"/></div>');
                //     $el.append($('<button type="button" class="remove"><i class="glyphicon glyphicon-trash"></i></button>').click(function () { $(this).parent().detach(); }));
                //     $(this).append($el);
                // }
                // else if (ui.draggable.text() == "Email") {
                //     var $el = $('<div class="drop-item form-group"><label><p onclick="editLabel(this)">' + ui.draggable.text() + '</p><input type="text" value="" name="" class="edit" id="edit" style="display: none;"></label><input class="form-control" type="email" /></div>');
                //     $el.append($('<button type="button" class="remove"><i class="glyphicon glyphicon-trash"></i></button>').click(function () { $(this).parent().detach(); }));
                //     $(this).append($el);
                // }
                // else if (ui.draggable.text() == "Radio Button") {
                //     var $el = $('<div class="drop-item form-group"><label><p onclick="editLabel(this)">' + ui.draggable.text() + '</p><input type="text" value="" name="" class="edit" id="edit" style="display: none;"></label><div class="radio"><label><input type="radio" name="optradio" checked>Option 1</label></div></div>');
                //     $el.append($('<button type="button" class="remove"><i class="glyphicon glyphicon-trash"></i></button>').click(function () { $(this).parent().detach(); }));
                //     $(this).append($el);
                // }
                // else {
                //     var $el = $('<div class="drop-item form-group"><label><p onclick="editLabel(this)">' + ui.draggable.text() + '</p><input type="text" value="" name="" class="edit" id="edit" style="display: none;"></label><input class="form-control" type="text" /></div>');
                //     $el.append($('<button type="button" class="remove"><i class="glyphicon glyphicon-trash"></i></button>').click(function () { $(this).parent().detach(); }));
                //     $(this).append($el);
                // }
            }
        }).sortable({
            items: '.drop-item',
            sort: function () {
                $(this).removeClass("active");
            }
        });
        function editLabel(elm) {
            var jelm = $(elm);
            var htmlElm = jelm[0];
            $(htmlElm).hide();
            $(htmlElm).siblings('.edit').show();
            $(htmlElm).siblings('.edit').focus()
            var initial_text = $(htmlElm).text();
            $(htmlElm).siblings('.edit').focusout(function () {
                var editedInput = $(htmlElm).siblings('.edit').val();
                $(htmlElm).siblings('.edit').hide();
                if (editedInput != '') {
                    $(htmlElm).show().text(editedInput);
                }
                else {
                    $(htmlElm).show().text(initial_text);
                }
            });
        }
    </script>

<%- include('../../templates/footer.ejs') %>